<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
<html lang="fr" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TutoAfrica - Espace Enseignant</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --vert-enseignant: #2D7D62;
            --largeur-sidebar: 280px;
            --vitesse: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        [data-bs-theme="light"] {
            --fond-page: #f1f5f9;
            --fond-carte: #ffffff;
            --fond-menu: #ffffff;
            --couleur-texte: #1e293b;
            --bordure: rgba(0,0,0,0.05);
        }

        [data-bs-theme="dark"] {
            --fond-page: #0f172a;
            --fond-carte: #1e293b;
            --fond-menu: #111827;
            --couleur-texte: #f8fafc;
            --bordure: rgba(255,255,255,0.1);
        }

        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: var(--fond-page); 
            color: var(--couleur-texte);
            transition: var(--vitesse);
        }

        .wrapper-menu { padding: 20px; height: 100vh; position: fixed; width: var(--largeur-sidebar); z-index: 1000; }
        .menu-lateral { 
            background: var(--fond-menu); 
            border: 1px solid var(--bordure); 
            border-radius: 24px; 
            height: 100%; 
            display: flex; 
            flex-direction: column; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        }

        .logo-tuto { padding: 30px 20px; text-align: center; }
        .logo-tuto a { text-decoration: none; color: var(--vert-enseignant); font-weight: 800; font-size: 1.4rem; }

        .carte-profil-menu {
            margin: 0 15px 25px;
            padding: 15px;
            background: var(--fond-page);
            border-radius: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: inherit;
            transition: var(--vitesse);
            border: 1px solid var(--bordure);
        }
        .carte-profil-menu:hover { transform: translateY(-2px); border-color: var(--vert-enseignant); }
        .img-avatar { width: 45px; height: 45px; border-radius: 12px; object-fit: cover; }

        .nav-link {
            margin: 4px 15px; padding: 12px 18px; border-radius: 14px;
            color: #94a3b8; font-weight: 600; transition: 0.3s;
        }
        .nav-link:hover { background: rgba(45, 125, 98, 0.1); color: var(--vert-enseignant); }
        .nav-link.active { background: var(--vert-enseignant) !important; color: white !important; }

        .contenu-principal { margin-left: var(--largeur-sidebar); padding: 40px; }

        .carte-dash {
            background: var(--fond-carte);
            border: 1px solid var(--bordure);
            border-radius: 28px;
            padding: 30px;
            height: 100%;
            transition: var(--vitesse);
        }
        .carte-dash:hover { transform: translateY(-8px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }

        .cercle-icone {
            width: 50px; height: 50px; border-radius: 15px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem; margin-bottom: 20px;
        }

        .btn-action {
            border-radius: 12px; padding: 12px; font-weight: 700; width: 100%; border: none; transition: 0.3s;
        }

        @media (max-width: 991px) {
            .wrapper-menu { display: none; }
            .contenu-principal { margin-left: 0; padding: 20px; }
        }
    </style>
</head>
<body>

<div class="modal fade" id="modalProfilProf" data-bs-backdrop="static" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow" style="border-radius: 24px;">
            <div class="modal-body p-4 text-center">
                <i class="bi bi-person-badge fs-1 text-success mb-3"></i>
                <h4 class="fw-bold" data-fr="ComplÃ©tez votre profil" data-en="Complete your profile">ComplÃ©tez votre profil</h4>
                <p class="text-muted small" data-fr="Ces informations aident les Ã©tudiants Ã  vous trouver." data-en="This information helps students find you.">Ces informations aident les Ã©tudiants Ã  vous trouver.</p>
                
                <div class="text-start mb-3">
                    <label class="small fw-bold mb-1" data-fr="MatiÃ¨re principale" data-en="Main subject">MatiÃ¨re principale</label>
                    <input type="text" id="nouveau-matiere" class="form-control py-2" placeholder="Ex: MathÃ©matiques">
                </div>

                <div class="text-start mb-4">
                    <label class="small fw-bold mb-1" data-fr="Votre diplÃ´me" data-en="Your degree">Votre diplÃ´me</label>
                    <select class="form-select py-2" id="nouveau-diplome">
                        <option value="IngÃ©nieur">IngÃ©nieur</option>
                        <option value="Doctorat">Doctorat (PhD)</option>
                        <option value="Master">Master / Professeur</option>
                    </select>
                </div>

                <button id="btn-sauver-prof" class="btn btn-success w-100 py-3 fw-bold" style="background: var(--vert-enseignant); border-radius: 12px;" data-fr="Enregistrer" data-en="Save changes">
                    Enregistrer
                </button>
            </div>
        </div>
    </div>
</div>

<div class="wrapper-menu">
    <aside class="menu-lateral">
        <div class="logo-tuto">
            <a href="index.html">TutoAfrica</a>
        </div>

        <a href="" class="carte-profil-menu">
            <img src="https://ui-avatars.com/api/?name=Prof&background=2D7D62&color=fff" class="img-avatar" id="prof-photo">
            <div class="overflow-hidden">
                <div class="fw-bold text-truncate small" id="prof-nom">Chargement...</div>
                <div class="text-muted" style="font-size: 0.7rem;" data-fr="Espace Enseignant" data-en="Teacher Space">Espace Enseignant</div>
            </div>
        </a>
        
        <nav class="nav nav-pills flex-column">
            <a href="#" class="nav-link active"><i class="bi bi-house-door me-3"></i> <span data-fr="Dashboard" data-en="Dashboard">Dashboard</span></a>
            <a href="sessiontutorat.html" class="nav-link"><i class="bi bi-calendar-event me-3"></i> <span data-fr="Mes sessions" data-en="My sessions">Mes sessions</span></a>
            <a href="Ressources/epreuve.html" class="nav-link"><i class="bi bi-folder me-3"></i> <span data-fr="Ressources" data-en="Resources">Ressources</span></a>
            <a href="discussionPeerToPeer.html" class="nav-link"><i class="bi bi-chat-dots me-3"></i> <span data-fr="Discussions" data-en="Discussions">Discussions</span></a>
        </nav>

        <div class="mt-auto p-3">
            <select class="form-select form-select-sm mb-3" style="border-radius: 8px;" id="langSelector" onchange="changerLangue(this.value)">
                <option value="fr">ðŸ‡¨ðŸ‡² FranÃ§ais</option>
                <option value="en">ðŸ‡¬ðŸ‡§ English</option>
            </select>
            <button onclick="deconnexion()" class="btn btn-link text-danger text-decoration-none fw-bold small p-0">
                <i class="bi bi-power me-2"></i> <span data-fr="DÃ©connexion" data-en="Logout">DÃ©connexion</span>
            </button>
        </div>
    </aside>
</div>

<main class="contenu-principal">
    <header class="mb-5">
        <h1 class="fw-800"><span data-fr="Bienvenue" data-en="Welcome">Bienvenue</span> <span id="salut-prof"></span> ! </h1>
        <p class="text-muted" data-fr="GÃ©rez vos sessions de tutorat et partagez vos ressources." data-en="Manage your tutoring sessions and share your resources.">GÃ©rez vos sessions de tutorat et partagez vos ressources.</p>
    </header>

    <div class="row g-4 mb-5">
        <div class="col-md-6">
            <div class="carte-dash">
                <div class="cercle-icone bg-success-subtle text-success">
                    <i class="bi bi-calendar-plus"></i>
                </div>
                <h4 class="fw-bold" data-fr="Lancer un tutorat" data-en="Start tutoring">Lancer un tutorat</h4>
                <p class="text-muted small mb-4" data-fr="Aidez un groupe d'Ã©tudiants en direct." data-en="Help a group of students live.">Aidez un groupe d'Ã©tudiants en direct.</p>
            
                <a href="sessiontutorat.html"><button  class="btn-action btn-success text-white" style="background: var(--vert-enseignant);" data-fr="Nouvelle session" data-en="New session" window.location.href = "sessiontutorat.html">
                    Nouvelle session
                </button></a>
            </div>
        </div>

        <div class="col-md-6">
            <div class="carte-dash">
                <div class="cercle-icone bg-primary-subtle text-primary">
                    <i class="bi bi-cloud-arrow-up"></i>
                </div>
                <h4 class="fw-bold" data-fr="Partager des fichiers" data-en="Share files">Partager des fichiers</h4>
                <p class="text-muted small mb-4" data-fr="Mettez Ã  disposition vos Ã©preuves et cours." data-en="Upload your exams and courses.">Mettez Ã  disposition vos Ã©preuves et cours.</p>
                <button class="btn-action btn-primary" data-fr="Importer" data-en="Upload">
                    Importer
                </button>
            </div>
        </div>
    </div>

    <div class="carte-dash p-4">
        <h5 class="fw-bold mb-4" data-fr="ActivitÃ©s rÃ©centes" data-en="Recent activities">ActivitÃ©s rÃ©centes</h5>
        <div class="text-center py-5">
            <div class="spinner-grow text-success opacity-25 mb-3" role="status"></div>
            <p class="text-muted small" data-fr="Aucune activitÃ© pour le moment." data-en="No activity yet.">Aucune activitÃ© pour le moment.</p>
        </div>
    </div>
</main>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore, doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // Ta config Firebase
    const firebaseConfig = {
        apiKey: "AIzaSyAvjQaWPrA7M5b0XmDrrBwTKDlv5q-nXDM",
        authDomain: "isi3projetwebgroupe6fr.firebaseapp.com",
        projectId: "isi3projetwebgroupe6fr",
        storageBucket: "isi3projetwebgroupe6fr.firebasestorage.app",
        messagingSenderId: "1024122923638",
        appId: "1:1024122923638:web:f1a367d84a567449494d57"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Fonction de changement de langue
    window.changerLangue = (lang) => {
        localStorage.setItem('appLang', lang);
        document.querySelectorAll('[data-en]').forEach(el => {
            el.textContent = el.getAttribute(`data-${lang}`);
        });
    };

    onAuthStateChanged(auth, async (user) => {
        if (user) {
            const docRef = doc(db, "utilisateurs", user.uid);
            const docSnap = await getDoc(docRef);

            if (docSnap.exists()) {
                const data = docSnap.data();
                
                // Remplissage nom
                document.getElementById('prof-nom').textContent = data.nom;
                document.getElementById('salut-prof').textContent = data.nom;
                if(user.photoURL) document.getElementById('prof-photo').src = user.photoURL;

                // Langue initiale
                const savedLang = localStorage.getItem('appLang') || 'fr';
                document.getElementById('langSelector').value = savedLang;
                changerLangue(savedLang);

                // VÃ©rification Profil Incomplet
                if (!data.matiere || data.matiere === "Non spÃ©cifiÃ©e") {
                    const profModal = new bootstrap.Modal(document.getElementById('modalProfilProf'));
                    profModal.show();
                }
            }
        } else {
            window.location.href = "connexion.html";
        }
    });

    // Sauvegarde Modal
    document.getElementById('btn-sauver-prof').addEventListener('click', async () => {
        const mat = document.getElementById('nouveau-matiere').value;
        const dip = document.getElementById('nouveau-diplome').value;
        if (!mat) return alert("PrÃ©cisez votre matiÃ¨re.");
        await updateDoc(doc(db, "utilisateurs", auth.currentUser.uid), { matiere: mat, diplome: dip });
        location.reload();
    });

    window.deconnexion = () => { signOut(auth).then(() => window.location.href = "index.html"); };

    // ThÃ¨me Auto
    const setTheme = () => {
        const isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        document.documentElement.setAttribute('data-bs-theme', isDark ? 'dark' : 'light');
    };
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', setTheme);
    setTheme();
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>